<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SSE</title>
</head>
<body>
<h2>Server events</h2>
<div id="log"></div>

<script>
    const sse = new EventSource(`http://${document.location.host}/v1/events`, {
        withCredentials: false,
    });
    const logElement = document.getElementById('log');
    const log = (msg) => logElement.innerHTML += msg + "<br>";

    sse.onmessage = function (event) {
        log("Message => " + event.data);
    };

    sse.addEventListener("close", (event) => {
        log("Stream closed by server: " + event.data);
        sse.close();
    });

    sse.onerror = function () {
        log("Connection lost (network/server error).");

        setTimeout(() => {
            logElement.innerHTML = '';
        }, 5000);
    };
</script>
</body>
</html>